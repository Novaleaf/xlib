{"version":3,"file":"security.js","sourceRoot":"","sources":["../../src/core/security.ts"],"names":[],"mappings":"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"}